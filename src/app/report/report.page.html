<ion-content>
  <ion-header>
    <ion-toolbar>
      <ion-buttons slot="start">
        <ion-back-button defaultHref="/tabs"></ion-back-button>
      </ion-buttons>
      <ion-title>Create Report</ion-title>
      
    </ion-toolbar>
  </ion-header>

  <ion-label
    class="title-info"
    style="
      display: flex;
      justify-content: center;
      padding: 25px;
      font-size: 20px;
    "
    >INCIDENT RECORD FORM</ion-label
  >

  <div class="segment-container"  [ngClass]="{'expanded': isExpanded}">
    <ion-segment
      [(ngModel)]="selectedSegment"
      (ionChange)="segmentChanged($event)"
      class="custom-segment"
    >
      <ion-segment-button value="1" class="segment-button" [disabled]="isSegmentDisabled('1')">
        <ion-label >Reporter Data</ion-label>
        <!-- <ion-label style="font-size: 7px">Reporting Person</ion-label> -->
      </ion-segment-button>
      <ion-segment-button value="2" class="segment-button">
        <ion-label>Suspect Data</ion-label>
        <!-- <ion-label style="font-size: 7px">Suspect Data</ion-label> -->
      </ion-segment-button>
      <ion-segment-button value="3" class="segment-button">
        <ion-label >Victim Data</ion-label>
        <!-- <ion-label style="font-size: 7px">Victim Data</ion-label> -->
      </ion-segment-button>
      <ion-segment-button value="4" class="segment-button">
        <ion-label style="font-size: 8px">Narrative Data</ion-label>
        <!-- <ion-label style="font-size: 7px">Narrative</ion-label> -->
      </ion-segment-button>
    </ion-segment>
  </div>

  <div *ngIf="selectedSegment === '1' && reporterType !== 'victim'" class="segment-content">
    <div class="item-a">
      <ion-list class="incident" lines="none">
        <ion-item class="incident-item">
          <ion-select
          [(ngModel)]="selectedIncidentID"
            class="custom-select"
            placeholder="Type of incident"
            interface="popover"
            (ionChange)="onCrimeChange($event)"
          >
          <ion-select-option
                *ngFor="let incident of incidentTypes"
                [value]="incident.incident_id"
              >
                {{ incident.name }}
              </ion-select-option>
          </ion-select>
        </ion-item>
      </ion-list>
      <div class="anonymous-person-info">
        <ion-label class="title-info-personal">PERSONAL INFORMATION</ion-label>
        <!-- <ion-button class="anonymous" size="small">
          Anonymous Report
        </ion-button> -->
        <ion-buttons slot="end">
          <ion-button class="load-data-btn"  (click)="retrieveSessionData()">
            <ion-icon name="refresh-outline"></ion-icon>
            Load My Data
          </ion-button>
        </ion-buttons>
      </div>
      <ion-list class="info" lines="none">
        <ion-item >
          <ion-input [(ngModel)]="witness.firstname" id="fname" placeholder="First Name" [disabled]="isDataLoaded"> </ion-input>
        </ion-item>

        <ion-item>
          <ion-input [(ngModel)]="witness.middlename" id="mname" placeholder="Middle Name" [disabled]="isDataLoaded"> </ion-input>
        </ion-item>

        <ion-item>
          <ion-input [(ngModel)]="witness.lastname" id="lname" placeholder="Last Name" [disabled]="isDataLoaded"> </ion-input>
        </ion-item>

        <ion-item>
          <ion-select  id="citizenship" placeholder="Citizenship" [(ngModel)]="witness.description.ethnicity">
            <ion-select-option *ngFor="let nationality of nationalities" [value]="nationality">
              {{ nationality }}
            </ion-select-option>
          </ion-select>
        </ion-item>

        <div class="detail-select">
          <ion-item class="dob">
            <ion-icon name="calendar" color="black"></ion-icon>
            <ion-input [(ngModel)]="witness.birthdate" [disabled]="isDataLoaded"
              name="dateOfbirth"
              [ngModelOptions]="{standalone: true}"
              placeholder="Date of Birth"
              value="{{ dateOfBirth | date: 'yyyy.MM.dd' }}"
              id="date"
              class="ion-text-end"
            ></ion-input>
            <ion-popover trigger="date" >
              <ng-template>
                <ion-datetime
                  presentation="date"
                  [(ngModel)]="dateOfBirth"
                  locale="en"  
                  (ionChange)="updateBirthdate()"
                ></ion-datetime>
              </ng-template>
            </ion-popover>
          </ion-item>

          <ion-item>
            <ion-select [(ngModel)]="witness.sex" id="gender" placeholder="Gender" [disabled]="isDataLoaded">
              <ion-select-option>Male</ion-select-option>
              <ion-select-option>Female</ion-select-option>
              <ion-select-option>Prefer not to say</ion-select-option>
            </ion-select>
          </ion-item>
        </div>

        
      <ion-item>
        <ion-select [(ngModel)]="witness.civilStatus" placeholder="Civil Status" [disabled]="isDataLoaded">
          <ion-select-option >Single</ion-select-option>
          <ion-select-option >Married</ion-select-option>
          <ion-select-option >Separated</ion-select-option>
          <ion-select-option >Divorced</ion-select-option>
          <ion-select-option >Widowed</ion-select-option>
        </ion-select>
      </ion-item>


        <ion-label class="title-info">CONTACT DETAILS</ion-label>

        <ion-item>
          <ion-input [(ngModel)]="witness.contactDetails.telNum" placeholder="Home Phone" [disabled]="isDataLoaded"> </ion-input>
        </ion-item>

        <ion-item>
          <ion-input [(ngModel)]="witness.contactDetails.mobileNum" id="mobileNum" placeholder="Mobile Number" [disabled]="isDataLoaded"> </ion-input>
        </ion-item>

        <ion-item>
          <ion-input [(ngModel)]="witness.contactDetails.email" id="email" placeholder="Email" [disabled]="isDataLoaded"> </ion-input>
        </ion-item>


        <ion-label class="title-info">HOME ADDRESS</ion-label>

        <ion-item>
          <ion-select [(ngModel)]="witness.homeAddress.region" name="homeregionName" placeholder="Region" (ionChange)="onHomeRegionChange($event)" [disabled]="isDataLoaded">
            <ion-select-option *ngFor="let region of regions" [value]="region.region_id">
              {{ region.region_name }}
            </ion-select-option>
          </ion-select>
        </ion-item>
        
        <ion-item>
          <ion-select [(ngModel)]="witness.homeAddress.province" name="homeprovinceName" placeholder="Province" (ionChange)="onHomeProvinceChange($event)" [disabled]="isDataLoaded">
            <ion-select-option *ngFor="let province of homeProvinces" [value]="province.province_id">
              {{ province.province_name }}
            </ion-select-option>
          </ion-select>
        </ion-item>
        
        <ion-item>
          <ion-select [(ngModel)]="witness.homeAddress.municipality" name="homemunicipalName" placeholder="Municipality" (ionChange)="onHomeMunicipalityChange($event)" [disabled]="isDataLoaded">
            <ion-select-option *ngFor="let municipality of homeMunicipalities" [value]="municipality.municipality_id">
              {{ municipality.municipality_name }}
            </ion-select-option>
          </ion-select>
        </ion-item>
        
        <ion-item>
          <ion-select [(ngModel)]="witness.homeAddress.barangay" name="homebrgyName" placeholder="Barangay" [disabled]="isDataLoaded">
            <ion-select-option *ngFor="let barangay of homeBarangays" [value]="barangay.barangay_id">
              {{ barangay.barangay_name }}
            </ion-select-option>
          </ion-select>
        </ion-item>
  
        <ion-item>
          <ion-input [(ngModel)]="witness.homeAddress.street" name="homestreetName" placeholder="Street" [disabled]="isDataLoaded"></ion-input>
        </ion-item>
  
        <ion-item>
          <ion-input [(ngModel)]="witness.homeAddress.block" name="homeblockName" placeholder="Block/Lot/Unit Number" [disabled]="isDataLoaded"></ion-input>
        </ion-item>
  
        <ion-item>
          <ion-input [(ngModel)]="comp_home_zip_code" name="homezip" placeholder="Zip Code" [disabled]="isDataLoaded"></ion-input>
        </ion-item>
  
        <ion-label class="title-info">WORK ADDRESS</ion-label>
  
        <!-- <div class="checkbox-container">
          <ion-checkbox name="disclaimer" labelPlacement="end" [(ngModel)]="isSameAddress" (ionChange)="onAddressCheckboxChange($event, 'witness')" ></ion-checkbox>
          <ion-label class="checkbox-label">Same as Home Address</ion-label>
  
        </div>
   -->
      <ion-item>
        <ion-input [(ngModel)]="witness.occupation.name" name="occupation" placeholder="Occupation" ></ion-input>
      </ion-item>

        <ion-item>
          <ion-select [(ngModel)]="witness.workAddress.region" name="workregionName" placeholder="Region" (ionChange)="onWorkRegionChange($event)" [disabled]="isDataLoaded">
            <ion-select-option *ngFor="let region of regions" [value]="region.region_id">
              {{ region.region_name }}
            </ion-select-option>
          </ion-select>
        </ion-item>
        
  
        <ion-item>
          <ion-select [(ngModel)]="witness.workAddress.province" name="workprovinceName" placeholder="Province" (ionChange)="onWorkProvinceChange($event)" [disabled]="isDataLoaded">
            <ng-container *ngIf="isSameAddress; else workProvinceOptions">
              <ion-select-option *ngFor="let province of homeProvinces" [value]="province.province_id">
                {{ province.province_name }}
              </ion-select-option>
            </ng-container>
            <ng-template #workProvinceOptions>
              <ion-select-option *ngFor="let province of workProvinces" [value]="province.province_id">
                {{ province.province_name }}
              </ion-select-option>
            </ng-template>
          </ion-select>
        </ion-item>
        
        <ion-item>
          <ion-select [(ngModel)]="witness.workAddress.municipality" name="workmunicipalName" placeholder="Municipality" (ionChange)="onWorkMunicipalityChange($event)" [disabled]="isDataLoaded">
            <ng-container *ngIf="isSameAddress; else workMunicipalityOptions">
              <ion-select-option *ngFor="let municipality of homeMunicipalities" [value]="municipality.municipality_id">
                {{ municipality.municipality_name }}
              </ion-select-option>
            </ng-container>
            <ng-template #workMunicipalityOptions>
              <ion-select-option *ngFor="let municipality of workMunicipalities" [value]="municipality.municipality_id">
                {{ municipality.municipality_name }}
              </ion-select-option>
            </ng-template>
          </ion-select>
        </ion-item>
        
        <ion-item>
          <ion-select [(ngModel)]="witness.workAddress.barangay" name="workbrgyName" placeholder="Barangay" [disabled]="isDataLoaded">
            <ng-container *ngIf="isSameAddress; else workBarangayOptions">
              <ion-select-option *ngFor="let barangay of homeBarangays" [value]="barangay.barangay_id">
                {{ barangay.barangay_name }}
              </ion-select-option>
            </ng-container>
            <ng-template #workBarangayOptions>
              <ion-select-option *ngFor="let barangay of workBarangays" [value]="barangay.barangay_id">
                {{ barangay.barangay_name }}
              </ion-select-option>
            </ng-template>
          </ion-select>
        </ion-item>
  
        <ion-item>
          <ion-input [(ngModel)]="witness.workAddress.street" name="workstreetName" placeholder="Street" [disabled]="isDataLoaded"></ion-input>
        </ion-item>
  
        <ion-item>
          <ion-input [(ngModel)]="witness.workAddress.block" name="workblockName" placeholder="Office/Bldg Name" [disabled]="isDataLoaded"></ion-input>
        </ion-item>
  
        <ion-item>
          <ion-input [(ngModel)]="comp_work_zip_code" name="workzip" placeholder="Zip Code" [disabled]="isDataLoaded"></ion-input>
        </ion-item>

        <ion-label class="title-info">ID DETAILS</ion-label>

        <ion-item>
          <ion-select placeholder="ID Presented">
            <ion-select-option *ngFor="let id of idOptions">
              {{ id }}
            </ion-select-option>
          </ion-select>
        </ion-item>

        <ion-item>
          <ion-input [(ngModel)]="idData.description" id="idNum" placeholder="ID Number"> </ion-input>
        </ion-item>
      </ion-list>

      <div id="uploadfile" class="uploadfile">
       <ion-label class="title-info">Upload your valid ID</ion-label>
          <input type="file" class="file" id="actual-btn"  (change)="onFileSelected($event)"  hidden/>
          <div class="icon-label">
            <ion-icon src="assets/upload.svg" class="upload-icon"></ion-icon>
            <label for="actual-btn">Upload file/s</label>
          </div>  
          <div *ngIf="fileName" class="file-name">{{ fileName }}
          <!-- <ion-button (click)="uploadFile()" *ngIf="selectedFile">Upload</ion-button>  -->
        </div>
          <p class="max-size">Maximum size up to 2GB</p>
      </div>

      <div class="next-container">
        <ion-button class="next" (click)="goToNextSegment(1)"
          >Next</ion-button
        >
        <!-- <ion-button style="--background: blue;" (click)="save()">Save</ion-button> -->
      </div>
    </div>
  </div>


















  <div *ngIf="selectedSegment === '2'" class="segment-content">
    <div class="item-b">
      <div class="checkbox-container">
        <ion-checkbox labelPlacement="end" [(ngModel)]="suspect.isUnidentified" (ionChange)="onSuspectIdentificationChange()"></ion-checkbox>
        <ion-label class="checkbox-label">Click here if the suspect is unidentified</ion-label>
      </div>
  
      <div [hidden]="suspect.isUnidentified">
        <div class="anonymous-person-info">
          <ion-label class="title-info-personal">PERSONAL INFORMATION</ion-label>
        </div>
        <ion-list class="info" lines="none">
          <ion-item>
            <ion-input [(ngModel)]="suspect.firstname" id="fname" placeholder="First Name"></ion-input>
          </ion-item>
  
          <ion-item>
            <ion-input [(ngModel)]="suspect.middlename" id="mname" placeholder="Middle Name"></ion-input>
          </ion-item>
  
          <ion-item>
            <ion-input [(ngModel)]="suspect.lastname" id="lname" placeholder="Last Name"></ion-input>
          </ion-item>
  
          <ion-item>
            <ion-select id="citizenship" placeholder="Citizenship" [(ngModel)]="suspect.description.ethnicity">
              <ion-select-option *ngFor="let nationality of nationalities" [value]="nationality">
                {{ nationality }}
              </ion-select-option>
            </ion-select>
          </ion-item>
  
          <div class="detail-select">
            <ion-item class="dob">
              <ion-icon name="calendar" color="black"></ion-icon>
              <ion-input [(ngModel)]="suspect.birthdate"
                name="dateOfbirth"
                [ngModelOptions]="{standalone: true}"
                placeholder="Date of Birth"
                value="{{ dateOfBirth | date: 'yyyy.MM.dd' }}"
                id="date"
                class="ion-text-end"
              ></ion-input>
              <ion-popover trigger="date">
                <ng-template>
                  <ion-datetime
                    presentation="date"
                    [(ngModel)]="dateOfBirth"
                    locale="en"  
                    (ionChange)="updateBirthdate()"
                  ></ion-datetime>
                </ng-template>
              </ion-popover>
            </ion-item>
  
            <ion-item>
              <ion-select [(ngModel)]="suspect.sex" id="gender" placeholder="Gender">
                <ion-select-option>Male</ion-select-option>
                <ion-select-option>Female</ion-select-option>
                <ion-select-option>Prefer not to say</ion-select-option>
              </ion-select>
            </ion-item>
          </div>
  
          <ion-item>
            <ion-select [(ngModel)]="suspect.civilStatus" placeholder="Civil Status">
              <ion-select-option>Single</ion-select-option>
              <ion-select-option>Married</ion-select-option>
              <ion-select-option>Separated</ion-select-option>
              <ion-select-option>Divorced</ion-select-option>
              <ion-select-option>Widowed</ion-select-option>
            </ion-select>
          </ion-item>
  
          <!-- <ion-item>
            <ion-input [(ngModel)]="suspect.contactDetails.telNum" placeholder="Home Phone"></ion-input>
          </ion-item>
  
          <ion-item>
            <ion-input [(ngModel)]="suspect.contactDetails.mobileNum" id="mobileNum" placeholder="Mobile Number"></ion-input>
          </ion-item>
  
          <ion-item>
            <ion-input [(ngModel)]="suspect.contactDetails.email" id="email" placeholder="Email"></ion-input>
          </ion-item> -->
  
          <ion-label class="title-info">HOME ADDRESS</ion-label>
  
          <ion-item>
            <ion-select [(ngModel)]="suspect.homeAddress.region" name="homeregionName" placeholder="Region" (ionChange)="onHomeRegionChange($event)">
              <ion-select-option *ngFor="let region of regions" [value]="region.region_id">
                {{ region.region_name }}
              </ion-select-option>
            </ion-select>
          </ion-item>
          
          <ion-item>
            <ion-select [(ngModel)]="suspect.homeAddress.province" name="homeprovinceName" placeholder="Province" (ionChange)="onHomeProvinceChange($event)">
              <ion-select-option *ngFor="let province of homeProvinces" [value]="province.province_id">
                {{ province.province_name }}
              </ion-select-option>
            </ion-select>
          </ion-item>
          
          <ion-item>
            <ion-select [(ngModel)]="suspect.homeAddress.municipality" name="homemunicipalName" placeholder="Municipality" (ionChange)="onHomeMunicipalityChange($event)">
              <ion-select-option *ngFor="let municipality of homeMunicipalities" [value]="municipality.municipality_id">
                {{ municipality.municipality_name }}
              </ion-select-option>
            </ion-select>
          </ion-item>
          
          <ion-item>
            <ion-select [(ngModel)]="suspect.homeAddress.barangay" name="homebrgyName" placeholder="Barangay">
              <ion-select-option *ngFor="let barangay of homeBarangays" [value]="barangay.barangay_id">
                {{ barangay.barangay_name }}
              </ion-select-option>
            </ion-select>
          </ion-item>
  
          <ion-item>
            <ion-input [(ngModel)]="suspect.homeAddress.street" name="homestreetName" placeholder="Street"></ion-input>
          </ion-item>
  
          <ion-item>
            <ion-input [(ngModel)]="suspect.homeAddress.block" name="homeblockName" placeholder="Block/Lot/Unit Number"></ion-input>
          </ion-item>
  
          <ion-item>
            <ion-input [(ngModel)]="sus_home_zip_code" name="workzip" placeholder="Zip Code"></ion-input>
          </ion-item>
  
          <ion-label class="title-info">WORK ADDRESS</ion-label>
  
          <ion-item>
            <ion-input [(ngModel)]="suspect.occupation.name" name="occupation" placeholder="Occupation"></ion-input>
          </ion-item>
  
          <ion-item>
            <ion-select [(ngModel)]="suspect.workAddress.region" name="workregionName" placeholder="Region" (ionChange)="onWorkRegionChange($event)">
              <ion-select-option *ngFor="let region of regions" [value]="region.region_id">
                {{ region.region_name }}
              </ion-select-option>
            </ion-select>
          </ion-item>
  
          <ion-item>
            <ion-select [(ngModel)]="suspect.workAddress.province" name="workprovinceName" placeholder="Province" (ionChange)="onWorkProvinceChange($event)">
              <ng-container *ngIf="isSameAddress; else workProvinceOptions">
                <ion-select-option *ngFor="let province of homeProvinces" [value]="province.province_id">
                  {{ province.province_name }}
                </ion-select-option>
              </ng-container>
              <ng-template #workProvinceOptions>
                <ion-select-option *ngFor="let province of workProvinces" [value]="province.province_id">
                  {{ province.province_name }}
                </ion-select-option>
              </ng-template>
            </ion-select>
          </ion-item>
          
          <ion-item>
            <ion-select [(ngModel)]="suspect.workAddress.municipality" name="workmunicipalName" placeholder="Municipality" (ionChange)="onWorkMunicipalityChange($event)">
              <ng-container *ngIf="isSameAddress; else workMunicipalityOptions">
                <ion-select-option *ngFor="let municipality of homeMunicipalities" [value]="municipality.municipality_id">
                  {{ municipality.municipality_name }}
                </ion-select-option>
              </ng-container>
              <ng-template #workMunicipalityOptions>
                <ion-select-option *ngFor="let municipality of workMunicipalities" [value]="municipality.municipality_id">
                  {{ municipality.municipality_name }}
                </ion-select-option>
              </ng-template>
            </ion-select>
          </ion-item>
          
          <ion-item>
            <ion-select [(ngModel)]="suspect.workAddress.barangay" name="workbrgyName" placeholder="Barangay">
              <ng-container *ngIf="isSameAddress; else workBarangayOptions">
                <ion-select-option *ngFor="let barangay of homeBarangays" [value]="barangay.barangay_id">
                  {{ barangay.barangay_name }}
                </ion-select-option>
              </ng-container>
              <ng-template #workBarangayOptions>
                <ion-select-option *ngFor="let barangay of workBarangays" [value]="barangay.barangay_id">
                  {{ barangay.barangay_name }}
                </ion-select-option>
              </ng-template>
            </ion-select>
          </ion-item>
  
          <ion-item>
            <ion-input [(ngModel)]="suspect.workAddress.street" name="workstreetName" placeholder="Street"></ion-input>
          </ion-item>
  
          <ion-item>
            <ion-input [(ngModel)]="suspect.workAddress.block" name="workblockName" placeholder="Office/Bldg Name"></ion-input>
          </ion-item>
  
          <ion-item>
            <ion-input [(ngModel)]="sus_work_zip_code" name="homezip" placeholder="Zip Code"></ion-input>
          </ion-item>
        </ion-list>
      </div>
  
      <ion-label class="title-info">DESCRIPTION</ion-label>
      <ion-list class="info" lines="none">
        <ion-item>
          <ion-input [(ngModel)]="sus_height" id="height" placeholder="Height" ></ion-input>
          <ion-label slot="end">ft, in</ion-label>
        </ion-item>
  
        <ion-item>
          <ion-input [(ngModel)]="sus_weight" id="weight" placeholder="Weight" ></ion-input>
          <ion-label slot="end">kg</ion-label>
        </ion-item>
  
        <ion-item>
          <ion-input [(ngModel)]="suspect.description.eyeColor" id="eyecolor" placeholder="Color of Eyes"></ion-input>
        </ion-item>
  
        <ion-item>
          <ion-input id="eyedescription" placeholder="Description of eyes"></ion-input>
        </ion-item>
  
        <ion-item>
          <ion-input [(ngModel)]="suspect.description.hairColor" id="haircolor" placeholder="Color of hair"></ion-input>
        </ion-item>
  
        <div class="influence-under">
          <ion-label class="checkbox-label" style="font-size: 15px; text-align: start">Under the influence?</ion-label>
          <ion-checkbox [(ngModel)]="suspect.description.drug" id="drugs" labelPlacement="end"></ion-checkbox>
          <ion-label class="checkbox-label">Drugs</ion-label>
          <ion-checkbox [(ngModel)]="suspect.description.alcohol" id="liquor" labelPlacement="end"></ion-checkbox>
          <ion-label class="checkbox-label">Liquor</ion-label>
        </div>
  
        <ion-item class="sus-narrative">
          <ion-textarea [(ngModel)]="suspect.description.distinguishingMark" rows="15"
            id="suspect-narrative" class="suspect-textarea"
            placeholder="Other distinguishing features (describe in detail clothes, vehicle, sunglasses, weapon/s, scars and other data or activity of the suspect/s which were observed by the reporting person and/or witness/es to identify the suspect/s. These are important and may become evidence to identify, and link to the crime, the suspect/s) ">
          </ion-textarea>
        </ion-item>
      </ion-list>
  
      <ion-list>
        <ion-item *ngFor="let suspect of suspects">
          <ion-label>
            {{ suspect.firstname }} {{ suspect.lastname }} 
          </ion-label>
        </ion-item>
      </ion-list>
  
      <ion-button class="add-btn" (click)="navigateToAddSuspect()" [disabled]="suspect.isUnidentified">
        <ion-icon name="add-circle" style="margin: 5px;"></ion-icon>Add suspect
      </ion-button>
  
      <div class="next-container">
        <ion-button class="next" (click)="goToNextSegment(2)">Next</ion-button>
        <!-- <ion-button style="--background: blue;" (click)="save()">Save</ion-button> -->
      </div>
    </div>
  </div>


















  <div *ngIf="selectedSegment === '3'" class="segment-content">
    <div class="item-b">
      <!-- <div class="checkbox-container">
        <ion-checkbox labelPlacement="end" [(ngModel)]="isSamePerson" (ionChange)="proceedToNextSegment()"></ion-checkbox>
        <ion-label class="checkbox-label" 
          >Check here if the reporter is also a victim and thereafter proceed to item “D” </ion-label
        >
      </div> -->

      <ion-list class="incident" lines="none">
        <ion-item class="incident-item">
          <ion-select
          [(ngModel)]="selectedmodus"
            class="custom-select"
            placeholder="Modus Operandi"
            interface="popover"
            (ionChange)="onModusChange($event)"
          >
          
            <ion-select-option *ngFor="let method of modus" [value]="method">{{ method.method_name }}</ion-select-option>
          </ion-select>
        </ion-item>
      </ion-list>

      <div class="anonymous-person-info">
        <ion-label class="title-info-personal">PERSONAL INFORMATION</ion-label>
        <ion-buttons slot="end" *ngIf="reporterType === 'victim'">
          <ion-button class="load-data-btn"  (click)="retrieveSessionData()">
            <ion-icon name="refresh-outline"></ion-icon>
            Load My Data
          </ion-button>
        </ion-buttons>
      </div>
      <ion-list class="info" lines="none">
        <ion-item>
          <ion-input [(ngModel)]="victim.firstname" id="fname" placeholder="First Name" [disabled]="isSamePerson"> </ion-input>
        </ion-item>

        <ion-item>
          <ion-input [(ngModel)]="victim.middlename" id="mname" placeholder="Middle Name" [disabled]="isSamePerson"> </ion-input>
        </ion-item>

        <ion-item>
          <ion-input [(ngModel)]="victim.lastname" id="lname" placeholder="Last Name" [disabled]="isSamePerson"> </ion-input>
        </ion-item>

        <ion-item>
          <ion-select id="citizenship" placeholder="Citizenship" [(ngModel)]="victim.description.ethnicity" [disabled]="isSamePerson">
            <ion-select-option *ngFor="let nationality of nationalities" [value]="nationality" [disabled]="suspect.isUnidentified">
              {{ nationality }}
            </ion-select-option>
          </ion-select>
        </ion-item>

        <div class="detail-select">
          <ion-item class="dob">
            <ion-icon name="calendar" color="black"></ion-icon>
            <ion-input [(ngModel)]="victim.birthdate"
              name="dateOfbirth"
              [ngModelOptions]="{standalone: true}"
              placeholder="Date of Birth"
              value="{{ dateOfBirth | date: 'yyyy.MM.dd' }}"
              id="date"
              class="ion-text-end"
            ></ion-input>
            <ion-popover trigger="date" >
              <ng-template>
                <ion-datetime
                  presentation="date"
                  [(ngModel)]="dateOfBirth"
                  locale="en"  
                  (ionChange)="updateBirthdate()"
                ></ion-datetime>
              </ng-template>
            </ion-popover>
          </ion-item>
          <ion-item>
            <ion-select [(ngModel)]="victim.sex"  id="gender" placeholder="Gender" [disabled]="isSamePerson">
              <ion-select-option>Male</ion-select-option>
              <ion-select-option>Female</ion-select-option>
              <ion-select-option>Prefer not to say</ion-select-option>
            </ion-select>
          </ion-item>
        </div>

        
      <ion-item>
        <ion-select [(ngModel)]="victim.civilStatus" placeholder="Civil Status" [disabled]="isSamePerson">
          <ion-select-option >Single</ion-select-option>
          <ion-select-option >Married</ion-select-option>
          <ion-select-option >Separated</ion-select-option>
          <ion-select-option >Divorced</ion-select-option>
          <ion-select-option >Widowed</ion-select-option>
        </ion-select>
      </ion-item>

        <ion-item>
          <ion-input [(ngModel)]="victim.contactDetails.telNum" placeholder="Home Phone" [disabled]="isSamePerson"> </ion-input>
        </ion-item>

        <ion-item>
          <ion-input [(ngModel)]="victim.contactDetails.mobileNum" id="mobileNum" placeholder="Mobile Number" [disabled]="suspect.isUnidentified"> </ion-input>
        </ion-item>

        <ion-item>
          <ion-input [(ngModel)]="victim.contactDetails.email" id="email" placeholder="Email" [disabled]="isSamePerson"> </ion-input>
        </ion-item>


        <ion-label class="title-info">HOME ADDRESS</ion-label>

        <ion-item>
          <ion-select [(ngModel)]="victim.homeAddress.region" name="homeregionName" placeholder="Region" 
          [disabled]="isSamePerson" (ionChange)="onHomeRegionChange($event)">
            <ion-select-option *ngFor="let region of regions" [value]="region.region_id">
              {{ region.region_name }}
            </ion-select-option>
          </ion-select>
        </ion-item>
        
        <ion-item>
          <ion-select [(ngModel)]="victim.homeAddress.province" name="homeprovinceName" placeholder="Province" (ionChange)="onHomeProvinceChange($event)" [disabled]="isSamePerson" >
            <ion-select-option *ngFor="let province of homeProvinces" [value]="province.province_id">
              {{ province.province_name }}
            </ion-select-option>
          </ion-select>
        </ion-item>
        
        <ion-item>
          <ion-select [(ngModel)]="victim.homeAddress.municipality" name="homemunicipalName" placeholder="Municipality" 
          [disabled]="isSamePerson" (ionChange)="onHomeMunicipalityChange($event)">
            <ion-select-option *ngFor="let municipality of homeMunicipalities" [value]="municipality.municipality_id">
              {{ municipality.municipality_name }}
            </ion-select-option>
          </ion-select>
        </ion-item>
        
        <ion-item>
          <ion-select [(ngModel)]="victim.homeAddress.barangay" name="homebrgyName" placeholder="Barangay" [disabled]="isSamePerson" >
            <ion-select-option *ngFor="let barangay of homeBarangays" [value]="barangay.barangay_id">
              {{ barangay.barangay_name }}
            </ion-select-option>
          </ion-select>
        </ion-item>
  
        <ion-item>
          <ion-input [(ngModel)]="victim.homeAddress.street" name="homestreetName" placeholder="Street" [disabled]="isSamePerson"></ion-input>
        </ion-item>
  
        <ion-item>
          <ion-input [(ngModel)]="victim.homeAddress.block" name="homeblockName" placeholder="Block/Lot/Unit Number" [disabled]="isSamePerson" ></ion-input>
        </ion-item>
  
        <ion-item>
          <ion-input [(ngModel)]="vic_home_zip_code" name="workzip" placeholder="Zip Code" [disabled]="isSamePerson"></ion-input>
        </ion-item>
  
        <ion-label class="title-info">WORK ADDRESS</ion-label>
  
        <!-- <div class="checkbox-container">
          <ion-checkbox name="disclaimer" labelPlacement="end" [(ngModel)]="isSameAddress" [disabled]="isSamePerson" (ionChange)="onAddressCheckboxChange($event, 'suspect')" ></ion-checkbox>
          <ion-label class="checkbox-label">Same as Home Address</ion-label>
  
        </div> -->
        
        <ion-item>
          <ion-input [(ngModel)]="victim.occupation.name" name="occupation" placeholder="Occupation"></ion-input>
        </ion-item>
  
        <ion-item>
          <ion-select [(ngModel)]="victim.workAddress.region" name="workregionName" placeholder="Region" [disabled]="isSamePerson"
           (ionChange)="onWorkRegionChange($event)" >
            <ion-select-option *ngFor="let region of regions" [value]="region.region_id">
              {{ region.region_name }}
            </ion-select-option>
          </ion-select>
        </ion-item>
        
  
        <ion-item>
          <ion-select [(ngModel)]="victim.workAddress.province" name="workprovinceName" placeholder="Province" [disabled]="isSamePerson" (ionChange)="onWorkProvinceChange($event)">
            <ng-container *ngIf="isSameAddress; else workProvinceOptions">
              <ion-select-option *ngFor="let province of homeProvinces" [value]="province.province_id">
                {{ province.province_name }}
              </ion-select-option>
            </ng-container>
            <ng-template #workProvinceOptions>
              <ion-select-option *ngFor="let province of workProvinces" [value]="province.province_id">
                {{ province.province_name }}
              </ion-select-option>
            </ng-template>
          </ion-select>
        </ion-item>
        
        <ion-item>
          <ion-select [(ngModel)]="victim.workAddress.municipality" name="workmunicipalName" placeholder="Municipality" [disabled]="isSamePerson" (ionChange)="onWorkMunicipalityChange($event)">
            <ng-container *ngIf="isSameAddress; else workMunicipalityOptions">
              <ion-select-option *ngFor="let municipality of homeMunicipalities" [value]="municipality.municipality_id">
                {{ municipality.municipality_name }}
              </ion-select-option>
            </ng-container>
            <ng-template #workMunicipalityOptions>
              <ion-select-option *ngFor="let municipality of workMunicipalities" [value]="municipality.municipality_id">
                {{ municipality.municipality_name }}
              </ion-select-option>
            </ng-template>
          </ion-select>
        </ion-item>
        
        <ion-item>
          <ion-select [(ngModel)]="victim.workAddress.barangay" name="workbrgyName" placeholder="Barangay" [disabled]="isSamePerson">
            <ng-container *ngIf="isSameAddress; else workBarangayOptions">
              <ion-select-option *ngFor="let barangay of homeBarangays" [value]="barangay.barangay_id">
                {{ barangay.barangay_name }}
              </ion-select-option>
            </ng-container>
            <ng-template #workBarangayOptions>
              <ion-select-option *ngFor="let barangay of workBarangays" [value]="barangay.barangay_id">
                {{ barangay.barangay_name }}
              </ion-select-option>
            </ng-template>
          </ion-select>
        </ion-item>
  
        <ion-item>
          <ion-input [(ngModel)]="victim.workAddress.street" name="workstreetName" placeholder="Street" [disabled]="isSamePerson"></ion-input>
        </ion-item>
  
        <ion-item>
          <ion-input [(ngModel)]="victim.workAddress.block" name="workblockName" placeholder="Office/Bldg Name" [disabled]="isSamePerson"></ion-input>
        </ion-item>

        <ion-item>
          <ion-input [(ngModel)]="vic_work_zip_code" name="homezip" placeholder="Zip Code" [disabled]="isSamePerson" ></ion-input>
        </ion-item>
      </ion-list>
    </div>
        
        <ion-button class="add-btn" [disabled]="isSamePerson"><ion-icon name="add-circle" style="margin: 5px;" ></ion-icon>Add victim</ion-button>
      
      <div class="next-container">
        <ion-button class="next" (click)="goToNextSegment(3)"
          >Next</ion-button
        >
       <!-- <ion-button style="--background: blue;" (click)="save()">Save</ion-button> -->
      </div>
    </div>






















    


  <div *ngIf="selectedSegment === '4'" class="segment-content">
    
    <ion-list class="info" lines="none">

      <ion-label class="title-info">INCIDENT DETAILS</ion-label>

      <ion-item class="incident-date">
        <ion-icon name="calendar" color="black"></ion-icon>
        <ion-input
          [(ngModel)]="reportData.incidentDate"
          name="dateOfIncident"
          [ngModelOptions]="{standalone: true}"
          placeholder="Date of Incident"
          value="{{ incidentDate | date: 'yyyy.MM.dd' }}"
          id="incidentDate"
          class="ion-text-end"
        ></ion-input>
        <ion-popover trigger="incidentDate">
          <ng-template>
            <ion-datetime
              presentation="date"
              [(ngModel)]="incidentDate"
              locale="en"
              (ionChange)="updateIncidentDate()"
            ></ion-datetime>
          </ng-template>
        </ion-popover>
      </ion-item>

      <ion-item class="incident-date">
        <ion-icon name="calendar" color="black"></ion-icon>
        <ion-input
          [(ngModel)]="reportData.reportedDate"
          name="reportedDate"
          [ngModelOptions]="{standalone: true}"
          placeholder="Reported Date"
          value="{{ reportedDate | date: 'yyyy.MM.dd' }}"
          id="reportedDate"
          class="ion-text-end"
        ></ion-input>
        <ion-popover trigger="reportedDate">
          <ng-template>
            <ion-datetime
              presentation="date"
              [(ngModel)]="reportedDate"
              locale="en"
              (ionChange)="updateReportedDate()"
            ></ion-datetime>
          </ng-template>
        </ion-popover>
      </ion-item>

      <!-- <ion-item>
        <ion-input id="incident-time" placeholder="Time"> </ion-input>
      </ion-item> -->

      <ion-item>
        <ion-input id="incident-place" placeholder="Place of incident"> </ion-input>
      </ion-item>

      

      <ion-item class="narrative">
        <ion-textarea rows="15" [(ngModel)]="reportData.reportBody"
          id="narrative" class="textarea"
          placeholder="Enter in detail the narrative of the incident or event, answering the WHO, WHAT, WHEN, WHERE, WHY and HOW."
        >
        </ion-textarea>
      </ion-item>
      <div class="add-items">
        <ion-button class="add-btn" routerLink="/add-witness"><ion-icon name="add-circle" style="margin: 5px;"></ion-icon>Add witness</ion-button>
      
       <ion-button class="add-btn" routerLink="/add-evidence"><ion-icon name="add-circle" style="margin: 5px;"></ion-icon>Add Evidence</ion-button>
      </div>

      <ion-button (click)="openSignatureModal()">Sign Here</ion-button> 
      
    </ion-list>
    <div class="next-container">
      <!-- <ion-button style="--background: blue;" (click)="save()">Save</ion-button> -->
      <ion-button class="next" style="width: 200px; font-size: small;"  (click)="save()"
        >Submit Report</ion-button
      >
      <ion-loading 
        class="custom-loading" 
        [isOpen]="loading" 
        [message]="loadingMessage"> 
    </ion-loading>


    </div>
    <ion-modal class="custom-modal" id="confirmationModal" [isOpen]="isModalOpen" (willDismiss)="closeModal()">
      <ng-template>
      <ion-header>
        <ion-toolbar>
          <ion-title>Confirm Message</ion-title>
          <ion-buttons slot="end">
            <ion-button (click)="closeModal()">Close</ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>
      <ion-content>
        <div class="content">
          <p>
            This is to confirm and acknowledge that your report has been forwarded to <b>{{stationName}}</b>
          </p>
        </div>
        
        <div class="home-button-modal">
          <ion-button expand="full" (click)="goBack()">Go back to Homepage</ion-button>
        </div>
       
      </ion-content>
    </ng-template>
    </ion-modal>
  </div>
     
  
   
</ion-content>
